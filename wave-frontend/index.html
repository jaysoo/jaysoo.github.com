<!doctype html>  
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    
    <title>Scaling JavaScript Applications / Future of Wave Front-End</title>

    <meta name="description" content="Backbone.js, RequireJS and CoffeeScript">
    <meta name="author" content="Jack Hsu">
    
    <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    
    <link rel="stylesheet" href="assets/css/reset.css">
    <link rel="stylesheet" href="assets/css/main.css">

    <link rel="stylesheet" href="assets/css/zenburn.css">

    <style>
      ul, ol {
        padding-left: 40px !important;
      }
      li, dd {
        margin: 10px 0;
      }
      dl {
        text-align: left;
      }
      dt {
        font-weight: bold;
      }
      dd {
        margin-left: 40px;
      }
      img.full-image {
        width: 100%;
      }
      pre code {
        font-size: 16px;
        line-height: 1.3;
      }
      pre.code-large code {
        font-size: 24px;
      }
      .overlay {
        background-color: rgba(0, 0, 0, 0.4);
      }
    </style>
  </head>
  
  <body>
    
    <div id="reveal">
      
      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">
        <section>
          <h1>Scaling JavaScript Applications</h1>
          <h3 class="inverted">The future of Wave front-end</h3>
          <script>
            // Delicously hacky. Look away.
            if( navigator.userAgent.match( /(iPhone|iPad|iPod|Android)/i ) )
            document.write( '<p style="color: rgba(0,0,0,0.3); text-shadow: none;">('+'Tap to navigate'+')</p>' );
          </script>
        </section>

        <section>
          <h3>Where we're heading</h3>
          <ul>
            <li>CoffeeScript</li>
            <li>AMD</li>
            <li>Backbone.js</li>
            <li>100% test coverage</li>
          </ul>
        </section>
        
        <section>
          <section style="background-image:url(assets/img/wild_west.jpg); background-size: 100%">
            <h3 class="overlay">Current Wave Accounting front-end</h3>
          </section>

          <section>
            <h3>Spaghetti</h3>
            <ul>
              <li class="fragment">Looks good from the outside</li>
              <li class="fragment">Tastes nice</li>
              <li class="fragment">A mess to clean up</li>
            </ul>
          </section>
        </section>

        <section>
          <h3>The issues</h3>
          <ul>
            <li>Code quality</li>
            <li>Lack of structure and organization</li>
            <li>Lack of testing</li>
          </ul>
        </section>

        <section>
          <h3>Prevents us from...</h3>
          <ul>
            <li>Creating great UX</li>
            <li>Innovating</li>
            <li>Proper maintenance</li>
          </ul>
        </section>
        
        <section>
          <h3>Agenda</h3>
          <ul>
            <li>Part 1
              <ul>
                <li>Primer on CoffeeScript and RequireJS</li>
                <li>Intro to Backbone.js</li>
                <li>Testing modules with Jasmine specs</li>
              </ul>
            </li>
            <li class="fragment">Part 2
              <ul>
                <li>Wave Front-End 2.0</li>
              </ul>
            </li>
          </ul>
        </section>

        <section>
          <h2>CoffeeScript</h2>
          <img src="assets/img/coffee.jpg" alt=""/>
        </section>

        <section>
          <h3>Main differences from JavaScript</h3>
          <ul>
            <li>Significant whitespace</li>
            <li>Semicolons not required</li>
            <li>No braces</li>
            <li>No <code>var</code> keyword</li>
            <li>Function declaration syntax</li>
            <li>Classes</li>
            <li>Comment syntax</li>
          </ul>
        </section>

        <section>
          <h3>Examples</h3>
          <pre class="code-large"><code># Assignment:
number = 42

# Functions:
square = (x) -> x * x

# Arrays:
list = [1, 2, 3, 4, 5]

# Objects:
math =
  root:   Math.sqrt
  square: square
  cube:   (x) -> x * square x
</code></pre>
        </section>

        <section>
          <section>
            <h3>OOP Example</h3>
            <pre class="code-large"><code style="font-size: 17px">class Animal
  constructor: (@name) ->

  move: (meters) ->
    alert @name + " moved #{meters}m."

class Snake extends Animal
  move: ->
    alert "Slithering..."
    super 5

class Horse extends Animal
  move: ->
    alert "Galloping..."
    super 45

sam = new Snake "Sammy the Python"
tom = new Horse "Tommy the Palomino"

sam.move()
tom.move()</code></pre>
          </section>

          <section>
            <h3>JavaScript OOP equivalent</h3>
            <pre class="code-large"><code style="font-size: 10px">var Animal, Horse, Snake, sam, tom, __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Animal = (function() {
  function Animal(name) { this.name = name; }
  Animal.prototype.move = function(meters) {
    return alert(this.name + (" moved " + meters + "m."));
  };
  return Animal;
})();

Snake = (function(_super) {
  __extends(Snake, _super);
  function Snake() { return Snake.__super__.constructor.apply(this, arguments); }
  Snake.prototype.move = function() {
    alert("Slithering...");
    return Snake.__super__.move.call(this, 5);
  };
  return Snake;
})(Animal);

Horse = (function(_super) {
  __extends(Horse, _super);
  function Horse() { return Horse.__super__.constructor.apply(this, arguments); }
  Horse.prototype.move = function() {
    alert("Galloping...");
    return Horse.__super__.move.call(this, 45);
  };
  return Horse;
})(Animal);

sam = new Snake("Sammy the Python");
tom = new Horse("Tommy the Palomino");

sam.move();
tom.move();</code></pre>
          </section>
        </section>

        <section>
          <h2>Modular JavaScript</h2>
          <img src="assets/img/gears.png" alt="">
        </section>

        <section>
          <h3>What are modules?</h3>
          <ul>
            <li>A module contains definitions of JavaScript functions and statements</li>
            <li>Highly decoupled, distinct pieces of functionality</li>
          </ul>
        </section>

        <section>
          <h3>How?</h3>
          <ol>
            <li>Implement your own module system</li>
            <li>CommonJS></li>
            <li>Use an AMD framework such as <a href="http://requirejs.org/">RequireJS</a></li>
            <li><s>ECMAScript Harmony</s></li>
          </ol>
        </section>

        <section>
          <h3>AMD</h3>
          <p>Asynchronous Module Definition</p>
          <ul>
            <li>Mechanism for asynchronously defining loadable modules</li>
            <li>Non-blocking, parallel loading of modules</li>
          </ul>
        </section>

        <section>
          <h3>Why AMD?</h3>
          <ul>
            <li>Well-defined modules and dependencies</li>
            <li>Directly supported in the browser (unlike CommonJS)</li>
            <li>Stepping stone to ES Harmony</li>
          </ul>
        </section>

        <section>
          <h3>RequireJS</h3>
          <ul>
            <li>Supports nested and circular dependencies</li>
            <li>Optimizations available</li>
            <li>Asynchronous template loading</li>
          </ul>
        </section>

        <section>
          <h3>RequireJS: Defining and loading modules</h3>
          <pre class="code-large"><code contenteditable>### a.coffee
define (require, exports, module) ->
  A =
    foo: ->

  exports = A


# b.coffee
define (require, exports, module) ->
  A = require('a')

  B =
    bar: ->
      A.foo()

  exports = B</code></pre>
        </section>

        <section>
          <h3>External templates</h3>
          <pre class="code-large"><code>define (require, exports, module) ->
  _ = require('underscore')
  TemplateText = require('text!template.html')  

  exports = _.template(TemplateText)
</code></pre>
        </section>

        <section>
          <h2 class="inverted">Backbone.js</h2>
          <img src="assets/img/backbone.png" alt="Backbone">
        </section>

        <section>
          <h3>Overview of Backbone</h3>
          <ul>
            <li>Very lightweight</li>
            <li>Minimal dependencies: Underscore.js and jQuery/Zepto</li>
            <li>Uses MV* pattern</li>
            <li>Very close to Smalltalk-80's MVC pattern</li>
          </ul>
        </section>

        <section>
          <h3>MV* in Backbone</h3>
          <dl>
            <dt>Model</dt>
            <dd>Same as model in MVC</dd>
            <dt>View</dt>
            <dd>Similar to Controller in Smalltalk-80's MVC</dd>
            <dd>Takes in model and renders view</dd>
            <dd>Handles user interaction with view to update model</dd>
            <dd>Observes changes on model to update view</dd>
            <dt>Template<dt>
            <dd>Same as view in MVC</dd>
          </dl>
        </section>

        <section>
          <h3>Backbone components</h3>
          <ol>
            <li>Model</li>
            <li>Collection</li>
            <li>View</li>
            <li>Router</li>
          </ol>
        </section>

        <section>
          <section>
            <h3>Model</h3>
            <ul>
              <li>Extend from Backbone.Model</li>
              <li>Prototype chain is setup properly for you</li>
            </ul>
            <pre class="code-large"><code contenteditable>var Animal = Backbone.Model.extend({
  says: function() { return '?'; }
});

var Cat = Animal.extend({
  says: function() { return 'meow'; }
});

var cat = new Cat();
cat instanceof Cat; //--&gt; true
cat instanceof Animal; //--&gt; true
cat.says(); //--&gt; "meow"

cat.constructor.__super__.says.call(this); //--&gt; '?'</code></pre>
          </section>

          <section>
            <h3>Inheritance in VanillaJS</h3>
            <pre class="code-large"><code contenteditable>var Animal = function() {};
Animal.prototype.says = function() { return '?'; };

var Cat = function() {};
Cat.prototype = new Animal();
Cat.prototype.constructor = Cat;
Cat.prototype.constructor.__super__ = Animal.prototype;
Cat.prototype.says = function() { return 'meow'; };

var cat = new Cat();
cat instanceof Cat; //--&gt; true
cat instanceof Animal; //--&gt; true
cat.says(); //--&gt; "meow"

cat.constructor.__super__.says.call(cat); //--&gt; '?'</code></pre>
          </section>
        </section>

        <section>
          <h3>Collection</h3>
          <p>A collection is a collection of models</p>
          <pre class="code-large"><code contenteditable>var MyModel = Backbone.Model.extend({ });
var MyModelCollection = Backbone.Collection.extend({
model: MyModel
});</code></pre>
        </section>

        <section>
          <h3>View and template</h3>
          <ul>
            <li>View handles user interaction</li>
            <li>View handles updates to model or collection</li>
            <li>View updates UI based on changes to model or collection</li>
            <li>Template renders data as an UI element</li>
          </ul>
        </section>

        <section>
          <h3>View</h3>
          <ul>
            <li>A view is often associated with a model or collection, but not always</li>
            <li>Uses templates in its <code>render</code> function to render its UI element</li>
          </ul>
          <pre><code contenteditable>var MyView = Backbone.View.extend({
  // Compiles Underscore template for later use
  template: _.template('&lt;p&gt;&lt;%= message %&gt;&lt;/p&gt;'),

  render: function() {
    // Render the Underscore template
    $(this.el).html( this.template({ message: 'Hello World!'}) );
    return this;
  }
});
          </code></pre>
        </section>

        <section>
          <h3>Template</h3>
          <p>Backbone does restrict your choices of templates.</p>
          <p>You can use any templating language you want.</p>
          <ul class="fragment">
            <li>Underscore template</li>
            <li>Mustache</li>
            <li>Handlebars</li>
            <li>jQuery template</li>
            <li>dust.js</li>
          </ul>
        </section>

        <section>
          <h3>Handlebars</h3>
          <ul>
            <li>Extension of the Mustache templating language</li>
            <li>Supports limited logic in the templates layer</li>
            <li>Supports user-defined helper functions for generating HTML</li>
          </ul>
        </section>

        <section>
          <h3>Using templates in Backbone</h3>
          <p>Templates are used in the views to render data.</p>

          <pre ><code contenteditable>&lt;!-- HTML --&gt;
&lt;div id="myDiv"&gt;&lt;/div&gt;</code></pre>
          <pre ><code contenteditable>/* JavaScript */
var Person = Backbone.Model.extend({});

var PersonView = Backbone.View.extend({
  template: Handlebars.compile('&lt;p&lt;Hello {{firstName}} {{lastName}}&lt;/p&gt;'),
  
  render: function() {
    $(this.el).html( this.template(this.model.toJSON()) );
    return this;
  }
});

var john = new Person({ firstName: 'John', lastName: 'Smith' });
var view = new PersonView({ 
  el: $('#myDiv'),
  model: john
});</code></pre>
        </section>

        <section>
          <h3>Code reuse using mixins</h3>
          <p>A mixin defines attributes and functions that can be shared across different classes.</p>
          <pre class="code-large"><code contenteditable>var Mixins = {};

Mixins.Navigation = {
  open: function() { /* ... */ },
  close: function() { /* ... */ },
  toggle: function() { /* ... */ }
};

var Menu = Backbone.View.extend({ /* ... */ });
_.extend(Menu.prototype, Mixins.Navigation);

var menu = new Menu();
menu.toggle();</code></pre>
        </section>


        <section>
          <h1>THE END</h1>
          <p class="inverted">by Jack Hsu/ jaysoo.ca</p>
        </section>
      </div>

      <!-- The navigational controls UI -->
      <aside class="controls">
        <a class="left" href="#">&#x25C4;</a>
        <a class="right" href="#">&#x25BA;</a>
        <a class="up" href="#">&#x25B2;</a>
        <a class="down" href="#">&#x25BC;</a>
      </aside>

      <!-- Displays presentation progress, max value changes via JS to reflect # of slides -->
      <div class="progress"><span></span></div>
      
    </div>
    
    <script src="js/lib/reveal.js"></script>
    <script src="js/lib/highlight.js"></script>
    <script>
      var query = {};
      location.search.replace( /[A-Z0-9]+?=(\w*)/gi, function(a) {
        query[ a.split( '=' ).shift() ] = a.split( '=' ).pop();
      } );
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        mouseWheel: true,
        rollingLinks: true,
        theme: 'default',
        transition: 'default'
      });

      hljs.initHighlightingOnLoad();
    </script>

  </body>
</html>

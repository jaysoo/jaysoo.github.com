<!DOCTYPE html><html><head><title>editors.coffee</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="../../../docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../../../index.html" class="source"><span class="file_name">README</span></a><a href="../../../app/accounts/collections/account.coffee.html" class="source "><span class="base_path">app / accounts / collections / </span><span class="file_name">account.coffee</span></a><a href="../../../app/accounts/models/account.coffee.html" class="source "><span class="base_path">app / accounts / models / </span><span class="file_name">account.coffee</span></a><a href="../../../app/cheques/csmain.coffee.html" class="source "><span class="base_path">app / cheques / </span><span class="file_name">csmain.coffee</span></a><a href="../../../app/cheques/models/cheque_payment.coffee.html" class="source "><span class="base_path">app / cheques / models / </span><span class="file_name">cheque_payment.coffee</span></a><a href="../../../app/cheques/views/app.coffee.html" class="source "><span class="base_path">app / cheques / views / </span><span class="file_name">app.coffee</span></a><a href="../../../app/cheques/views/cheque_payment_form.coffee.html" class="source "><span class="base_path">app / cheques / views / </span><span class="file_name">cheque_payment_form.coffee</span></a><a href="../../../app/clients/collections/client_details.coffee.html" class="source "><span class="base_path">app / clients / collections / </span><span class="file_name">client_details.coffee</span></a><a href="../../../app/clients/collections/customer.coffee.html" class="source "><span class="base_path">app / clients / collections / </span><span class="file_name">customer.coffee</span></a><a href="../../../app/clients/models/client_details.coffee.html" class="source "><span class="base_path">app / clients / models / </span><span class="file_name">client_details.coffee</span></a><a href="../../../app/clients/models/customer.coffee.html" class="source "><span class="base_path">app / clients / models / </span><span class="file_name">customer.coffee</span></a><a href="../../../app/clients/views/client_details.coffee.html" class="source "><span class="base_path">app / clients / views / </span><span class="file_name">client_details.coffee</span></a><a href="../../../app/clients/views/client_details_form.coffee.html" class="source "><span class="base_path">app / clients / views / </span><span class="file_name">client_details_form.coffee</span></a><a href="../../../app/core/csmain.coffee.html" class="source "><span class="base_path">app / core / </span><span class="file_name">csmain.coffee</span></a><a href="../../../app/core/facade.coffee.html" class="source "><span class="base_path">app / core / </span><span class="file_name">facade.coffee</span></a><a href="../../../app/core/forms/editors.coffee.html" class="source selected"><span class="base_path">app / core / forms / </span><span class="file_name">editors.coffee</span></a><a href="../../../app/core/forms/form_templates.coffee.html" class="source "><span class="base_path">app / core / forms / </span><span class="file_name">form_templates.coffee</span></a><a href="../../../app/core/forms/views/dropdown.coffee.html" class="source "><span class="base_path">app / core / forms / views / </span><span class="file_name">dropdown.coffee</span></a><a href="../../../app/core/forms/views/form_field.coffee.html" class="source "><span class="base_path">app / core / forms / views / </span><span class="file_name">form_field.coffee</span></a><a href="../../../app/core/forms/views/option.coffee.html" class="source "><span class="base_path">app / core / forms / views / </span><span class="file_name">option.coffee</span></a><a href="../../../app/core/forms/views/two_step_dropdown.coffee.html" class="source "><span class="base_path">app / core / forms / views / </span><span class="file_name">two_step_dropdown.coffee</span></a><a href="../../../app/core/mediator.coffee.html" class="source "><span class="base_path">app / core / </span><span class="file_name">mediator.coffee</span></a><a href="../../../app/core/mixins.coffee.html" class="source "><span class="base_path">app / core / </span><span class="file_name">mixins.coffee</span></a><a href="../../../app/core/template_helpers.coffee.html" class="source "><span class="base_path">app / core / </span><span class="file_name">template_helpers.coffee</span></a><a href="../../../app/core/vendor.coffee.html" class="source "><span class="base_path">app / core / </span><span class="file_name">vendor.coffee</span></a><a href="../../../app/currency/collections/currency.coffee.html" class="source "><span class="base_path">app / currency / collections / </span><span class="file_name">currency.coffee</span></a><a href="../../../app/currency/models/currency.coffee.html" class="source "><span class="base_path">app / currency / models / </span><span class="file_name">currency.coffee</span></a><a href="../../../app/geography/collections/country.coffee.html" class="source "><span class="base_path">app / geography / collections / </span><span class="file_name">country.coffee</span></a><a href="../../../app/geography/collections/province.coffee.html" class="source "><span class="base_path">app / geography / collections / </span><span class="file_name">province.coffee</span></a><a href="../../../app/geography/models/country.coffee.html" class="source "><span class="base_path">app / geography / models / </span><span class="file_name">country.coffee</span></a><a href="../../../app/geography/models/province.coffee.html" class="source "><span class="base_path">app / geography / models / </span><span class="file_name">province.coffee</span></a><a href="../../../app/products/collections/product.coffee.html" class="source "><span class="base_path">app / products / collections / </span><span class="file_name">product.coffee</span></a><a href="../../../app/products/models/product.coffee.html" class="source "><span class="base_path">app / products / models / </span><span class="file_name">product.coffee</span></a><a href="../../../app/products/views/product_form.coffee.html" class="source "><span class="base_path">app / products / views / </span><span class="file_name">product_form.coffee</span></a><a href="../../../app/products/views/product_form_row.coffee.html" class="source "><span class="base_path">app / products / views / </span><span class="file_name">product_form_row.coffee</span></a><a href="../../../app/profiles/models/business.coffee.html" class="source "><span class="base_path">app / profiles / models / </span><span class="file_name">business.coffee</span></a><a href="../../../app/summaries/csmain.coffee.html" class="source "><span class="base_path">app / summaries / </span><span class="file_name">csmain.coffee</span></a><a href="../../../app/taxes/collections/tax.coffee.html" class="source "><span class="base_path">app / taxes / collections / </span><span class="file_name">tax.coffee</span></a><a href="../../../app/taxes/models/tax.coffee.html" class="source "><span class="base_path">app / taxes / models / </span><span class="file_name">tax.coffee</span></a><a href="../../../app/taxes/views/taxes_widget.coffee.html" class="source "><span class="base_path">app / taxes / views / </span><span class="file_name">taxes_widget.coffee</span></a><a href="../../../app/transactions/collections/payment.coffee.html" class="source "><span class="base_path">app / transactions / collections / </span><span class="file_name">payment.coffee</span></a><a href="../../../app/transactions/collections/record.coffee.html" class="source "><span class="base_path">app / transactions / collections / </span><span class="file_name">record.coffee</span></a><a href="../../../app/transactions/csmain.coffee.html" class="source "><span class="base_path">app / transactions / </span><span class="file_name">csmain.coffee</span></a><a href="../../../app/transactions/models/payment.coffee.html" class="source "><span class="base_path">app / transactions / models / </span><span class="file_name">payment.coffee</span></a><a href="../../../app/transactions/models/record.coffee.html" class="source "><span class="base_path">app / transactions / models / </span><span class="file_name">record.coffee</span></a><a href="../../../app/transactions/views/app.coffee.html" class="source "><span class="base_path">app / transactions / views / </span><span class="file_name">app.coffee</span></a><a href="../../../app/transactions/views/payment_form.coffee.html" class="source "><span class="base_path">app / transactions / views / </span><span class="file_name">payment_form.coffee</span></a><a href="../../../app/transactions/views/payment_row.coffee.html" class="source "><span class="base_path">app / transactions / views / </span><span class="file_name">payment_row.coffee</span></a><a href="../../../app/transactions/views/payment_table.coffee.html" class="source "><span class="base_path">app / transactions / views / </span><span class="file_name">payment_table.coffee</span></a><a href="../../../app/transactions/views/record_row.coffee.html" class="source "><span class="base_path">app / transactions / views / </span><span class="file_name">record_row.coffee</span></a><a href="../../../app/transactions/views/records_table.coffee.html" class="source "><span class="base_path">app / transactions / views / </span><span class="file_name">records_table.coffee</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>editors.coffee</h1><div class="filepath">app/core/forms/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">define</span> <span class="nf">(require, exports, module) -&gt;</span>
  <span class="nv">Form = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;backbone_forms&#39;</span><span class="p">)</span>
  <span class="nv">Base = </span><span class="nx">Form</span><span class="p">.</span><span class="nx">editors</span><span class="p">.</span><span class="nx">Base</span>

  <span class="nv">createTemplate = </span><span class="nx">Form</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">createTemplate</span>

  <span class="nv">triggerCancellableEvent = </span><span class="nx">Form</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">triggerCancellableEvent</span>

  <span class="nv">exports = </span><span class="p">{}</span>

  <span class="nx">exports</span><span class="p">[</span><span class="s">&quot;jqueryui.Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span>
    <span class="nv">className: </span><span class="s">&quot;bbf-jui-date&quot;</span>
    <span class="nv">initialize: </span><span class="nf">(options) -&gt;</span>
      <span class="nx">Base</span><span class="o">::</span><span class="nx">initialize</span><span class="p">.</span><span class="nx">call</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span>
      <span class="vi">@value = </span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">@value</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">@value</span> <span class="o">and</span> <span class="o">not</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isDate</span><span class="p">(</span><span class="nx">@value</span><span class="p">)</span>
      <span class="nx">unless</span> <span class="nx">@value</span>
        <span class="nv">date = </span><span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
        <span class="nx">date</span><span class="p">.</span><span class="nx">setSeconds</span> <span class="mi">0</span>
        <span class="nx">date</span><span class="p">.</span><span class="nx">setMilliseconds</span> <span class="mi">0</span>
        <span class="vi">@value = </span><span class="nx">date</span>

    <span class="nv">render: </span><span class="o">-&gt;</span>
      <span class="nv">$el = </span><span class="nx">@$el</span>
      <span class="nx">$el</span><span class="p">.</span><span class="nx">html</span> <span class="s">&#39;&lt;input class=&quot;text&quot;&gt;&#39;</span>
      <span class="nv">input = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span> <span class="nx">$el</span><span class="p">)</span>
      <span class="nx">input</span><span class="p">.</span><span class="nx">datepicker</span>
        <span class="nv">dateFormat: </span><span class="s">&quot;yy-mm-dd&quot;</span>
        <span class="nv">showButtonPanel: </span><span class="kc">true</span>

      <span class="nx">exports</span><span class="p">[</span><span class="s">&quot;jqueryui.Date&quot;</span><span class="p">]</span><span class="o">::</span><span class="nx">setValue</span><span class="p">.</span><span class="nx">call</span> <span class="k">this</span><span class="p">,</span> <span class="nx">@value</span>
      <span class="k">this</span>

    <span class="nv">getValue: </span><span class="o">-&gt;</span>
      <span class="nv">input = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span> <span class="nx">@el</span><span class="p">)</span>
      <span class="nv">date = </span><span class="nx">input</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">(</span><span class="s">&quot;getDate&quot;</span><span class="p">)</span>
      <span class="nx">date</span>

    <span class="nv">setValue: </span><span class="nf">(value) -&gt;</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span> <span class="nx">@el</span><span class="p">).</span><span class="nx">datepicker</span> <span class="s">&quot;setDate&quot;</span><span class="p">,</span> <span class="nx">value</span>
  <span class="p">)</span>

  <span class="nx">exports</span><span class="p">[</span><span class="s">&quot;jqueryui.DateTime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">[</span><span class="s">&quot;jqueryui.Date&quot;</span><span class="p">].</span><span class="nx">extend</span><span class="p">(</span>
    <span class="nv">className: </span><span class="s">&quot;bbf-jui-datetime&quot;</span>
    <span class="nv">template: </span><span class="nx">createTemplate</span><span class="p">(</span><span class="s">&quot;&lt;select&gt;{{hours}}&lt;/select&gt; : &lt;select&gt;{{mins}}&lt;/select&gt;&quot;</span><span class="p">)</span>
    <span class="nv">render: </span><span class="o">-&gt;</span>
      <span class="nv">pad = </span><span class="nf">(n) -&gt;</span>
        <span class="p">(</span><span class="k">if</span> <span class="nx">n</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="k">then</span> <span class="s">&quot;0&quot;</span> <span class="o">+</span> <span class="nx">n</span> <span class="k">else</span> <span class="nx">n</span><span class="p">)</span>
      <span class="nx">exports</span><span class="p">[</span><span class="s">&quot;jqueryui.Date&quot;</span><span class="p">]</span><span class="o">::</span><span class="nx">render</span><span class="p">.</span><span class="nx">call</span> <span class="k">this</span>
      <span class="nv">hours = </span><span class="nx">_</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
      <span class="nv">hoursOptions = </span><span class="p">[]</span>
      <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">hours</span><span class="p">,</span> <span class="nf">(hour) -&gt;</span>
        <span class="nx">hoursOptions</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;&lt;option value=\&quot;&quot;</span> <span class="o">+</span> <span class="nx">hour</span> <span class="o">+</span> <span class="s">&quot;\&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">pad</span><span class="p">(</span><span class="nx">hour</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&lt;/option&gt;&quot;</span>

      <span class="nv">minsInterval = </span><span class="nx">@schema</span><span class="p">.</span><span class="nx">minsInterval</span> <span class="o">or</span> <span class="mi">15</span>
      <span class="nv">mins = </span><span class="nx">_</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="nx">minsInterval</span><span class="p">)</span>
      <span class="nv">minsOptions = </span><span class="p">[]</span>
      <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">mins</span><span class="p">,</span> <span class="nf">(min) -&gt;</span>
        <span class="nx">minsOptions</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;&lt;option value=\&quot;&quot;</span> <span class="o">+</span> <span class="nx">min</span> <span class="o">+</span> <span class="s">&quot;\&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">pad</span><span class="p">(</span><span class="nx">min</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&lt;/option&gt;&quot;</span>

      <span class="nx">@$el</span><span class="p">.</span><span class="nx">append</span> <span class="nx">@template</span><span class="p">(</span>
        <span class="nv">hours: </span><span class="nx">hoursOptions</span><span class="p">.</span><span class="nx">join</span><span class="p">()</span>
        <span class="nv">mins: </span><span class="nx">minsOptions</span><span class="p">.</span><span class="nx">join</span><span class="p">()</span>
      <span class="p">)</span>
      <span class="vi">@$hours = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;select:eq(0)&quot;</span><span class="p">,</span> <span class="nx">@el</span><span class="p">)</span>
      <span class="vi">@$mins = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;select:eq(1)&quot;</span><span class="p">,</span> <span class="nx">@el</span><span class="p">)</span>
      <span class="nx">@setValue</span> <span class="nx">@value</span>
      <span class="k">this</span>

    <span class="nv">getValue: </span><span class="o">-&gt;</span>
      <span class="nv">input = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span> <span class="nx">@el</span><span class="p">)</span>
      <span class="nv">date = </span><span class="nx">input</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">(</span><span class="s">&quot;getDate&quot;</span><span class="p">)</span>
      <span class="nx">date</span><span class="p">.</span><span class="nx">setHours</span> <span class="nx">@$hours</span><span class="p">.</span><span class="nx">val</span><span class="p">()</span>
      <span class="nx">date</span><span class="p">.</span><span class="nx">setMinutes</span> <span class="nx">@$mins</span><span class="p">.</span><span class="nx">val</span><span class="p">()</span>
      <span class="nx">date</span><span class="p">.</span><span class="nx">setMilliseconds</span> <span class="mi">0</span>
      <span class="nx">date</span>

    <span class="nv">setValue: </span><span class="nf">(date) -&gt;</span>
      <span class="nx">exports</span><span class="p">[</span><span class="s">&quot;jqueryui.Date&quot;</span><span class="p">]</span><span class="o">::</span><span class="nx">setValue</span><span class="p">.</span><span class="nx">call</span> <span class="k">this</span><span class="p">,</span> <span class="nx">date</span>
      <span class="nx">@$hours</span><span class="p">.</span><span class="nx">val</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()</span>
      <span class="nx">@$mins</span><span class="p">.</span><span class="nx">val</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMinutes</span><span class="p">()</span>
  <span class="p">)</span>

  <span class="nx">exports</span><span class="p">[</span><span class="s">&quot;jqueryui.List&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span>
    <span class="nv">className: </span><span class="s">&quot;bbf-jui-list&quot;</span>
    <span class="nv">template: </span><span class="nx">createTemplate</span><span class="p">(</span><span class="s">&quot;      &lt;ul&gt;&lt;/ul&gt;      &lt;div&gt;&lt;button class=\&quot;bbf-list-add\&quot;&gt;Add&lt;/div&gt;    &quot;</span><span class="p">)</span>
    <span class="nv">itemTemplate: </span><span class="nx">createTemplate</span><span class="p">(</span><span class="s">&quot;      &lt;li rel=\&quot;{{id}}\&quot;&gt;        &lt;span class=\&quot;bbf-list-text\&quot;&gt;{{text}}&lt;/span&gt;        &lt;div class=\&quot;bbf-list-actions\&quot;&gt;          &lt;button class=\&quot;bbf-list-edit\&quot;&gt;Edit&lt;/button&gt;          &lt;button class=\&quot;bbf-list-del\&quot;&gt;Delete&lt;/button&gt;        &lt;/div&gt;      &lt;/li&gt;    &quot;</span><span class="p">)</span>
    <span class="nv">editorTemplate: </span><span class="nx">createTemplate</span><span class="p">(</span><span class="s">&quot;      &lt;div class=\&quot;bbf-field\&quot;&gt;          &lt;div class=\&quot;bbf-list-editor\&quot;&gt;&lt;/div&gt;      &lt;/div&gt;    &quot;</span><span class="p">)</span>
    <span class="nv">events:</span>
      <span class="s">&quot;click .bbf-list-add&quot;</span><span class="o">:</span> <span class="s">&quot;addNewItem&quot;</span>
      <span class="s">&quot;click .bbf-list-edit&quot;</span><span class="o">:</span> <span class="s">&quot;editItem&quot;</span>
      <span class="s">&quot;click .bbf-list-del&quot;</span><span class="o">:</span> <span class="s">&quot;deleteItem&quot;</span>

    <span class="nv">initialize: </span><span class="nf">(options) -&gt;</span>
      <span class="nx">Base</span><span class="o">::</span><span class="nx">initialize</span><span class="p">.</span><span class="nx">call</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span>
      <span class="k">throw</span> <span class="s">&quot;Missing required option &#39;schema&#39;&quot;</span>  <span class="nx">unless</span> <span class="nx">@schema</span>
      <span class="vi">@schema.listType = </span><span class="nx">@schema</span><span class="p">.</span><span class="nx">listType</span> <span class="o">or</span> <span class="s">&quot;Text&quot;</span>
      <span class="k">throw</span> <span class="s">&quot;Missing required option &#39;schema.model&#39;&quot;</span>  <span class="k">if</span> <span class="nx">@schema</span><span class="p">.</span><span class="nx">listType</span> <span class="o">is</span> <span class="s">&quot;NestedModel&quot;</span> <span class="o">and</span> <span class="o">not</span> <span class="nx">@schema</span><span class="p">.</span><span class="nx">model</span>

    <span class="nv">render: </span><span class="o">-&gt;</span>
      <span class="nv">$el = </span><span class="nx">@$el</span>
      <span class="nx">$el</span><span class="p">.</span><span class="nx">html</span> <span class="nx">@template</span><span class="p">()</span>
      <span class="nv">self = </span><span class="k">this</span>
      <span class="nv">data = </span><span class="nx">@value</span> <span class="o">or</span> <span class="p">[]</span>
      <span class="nv">schema = </span><span class="nx">@schema</span>
      <span class="nv">itemToString = </span><span class="nx">@itemToString</span>
      <span class="nv">itemTemplate = </span><span class="nx">@itemTemplate</span>
      <span class="nv">listEl = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;ul&quot;</span><span class="p">,</span> <span class="nx">$el</span><span class="p">)</span>
      <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">data</span><span class="p">,</span> <span class="nf">(itemData) -&gt;</span>
        <span class="nv">text = </span><span class="nx">itemToString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">self</span><span class="p">,</span> <span class="nx">itemData</span><span class="p">)</span>
        <span class="nv">li = </span><span class="nx">$</span><span class="p">(</span><span class="nx">itemTemplate</span><span class="p">(</span>
          <span class="nv">id: </span><span class="nx">itemData</span><span class="p">.</span><span class="nx">id</span> <span class="o">or</span> <span class="s">&quot;&quot;</span>
          <span class="nv">text: </span><span class="nx">text</span>
        <span class="p">))</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">data</span> <span class="nx">li</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="nx">itemData</span>
        <span class="nx">listEl</span><span class="p">.</span><span class="nx">append</span> <span class="nx">li</span>

      <span class="k">if</span> <span class="nx">schema</span><span class="p">.</span><span class="nx">sortable</span> <span class="o">isnt</span> <span class="kc">false</span>
        <span class="nx">listEl</span><span class="p">.</span><span class="nx">sortable</span>
          <span class="nv">axis: </span><span class="s">&quot;y&quot;</span>
          <span class="nv">cursor: </span><span class="s">&quot;move&quot;</span>
          <span class="nv">containment: </span><span class="s">&quot;parent&quot;</span>

        <span class="nx">$el</span><span class="p">.</span><span class="nx">addClass</span> <span class="s">&quot;bbf-list-sortable&quot;</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;button.bbf-list-add&quot;</span><span class="p">,</span> <span class="nx">$el</span><span class="p">).</span><span class="nx">button</span>
        <span class="nv">text: </span><span class="kc">false</span>
        <span class="nv">icons:</span>
          <span class="nv">primary: </span><span class="s">&quot;ui-icon-plus&quot;</span>

      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;button.bbf-list-edit&quot;</span><span class="p">,</span> <span class="nx">$el</span><span class="p">).</span><span class="nx">button</span>
        <span class="nv">text: </span><span class="kc">false</span>
        <span class="nv">icons:</span>
          <span class="nv">primary: </span><span class="s">&quot;ui-icon-pencil&quot;</span>

      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;button.bbf-list-del&quot;</span><span class="p">,</span> <span class="nx">$el</span><span class="p">).</span><span class="nx">button</span>
        <span class="nv">text: </span><span class="kc">false</span>
        <span class="nv">icons:</span>
          <span class="nv">primary: </span><span class="s">&quot;ui-icon-trash&quot;</span>

      <span class="k">this</span>

    <span class="nv">itemToString: </span><span class="nf">(data) -&gt;</span>
      <span class="k">return</span> <span class="nx">data</span>  <span class="nx">unless</span> <span class="nx">data</span>
      <span class="nv">schema = </span><span class="nx">@schema</span>
      <span class="k">return</span> <span class="nx">schema</span><span class="p">.</span><span class="nx">itemToString</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">schema</span><span class="p">.</span><span class="nx">itemToString</span>
      <span class="k">if</span> <span class="nx">@schema</span><span class="p">.</span><span class="nx">listType</span> <span class="o">is</span> <span class="s">&quot;NestedModel&quot;</span>
        <span class="nv">model = </span><span class="k">new</span> <span class="p">(</span><span class="nx">@schema</span><span class="p">.</span><span class="nx">model</span><span class="p">)(</span><span class="nx">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
      <span class="nx">data</span>

    <span class="nv">addNewItem: </span><span class="nf">(event) -&gt;</span>
      <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
      <span class="nv">self = </span><span class="k">this</span>
      <span class="nx">@openEditor</span> <span class="kc">null</span><span class="p">,</span> <span class="nf">(value) -&gt;</span>
        <span class="nx">triggerCancellableEvent</span> <span class="nx">self</span><span class="p">,</span> <span class="s">&quot;addItem&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="nx">value</span> <span class="p">],</span> <span class="o">-&gt;</span>
          <span class="nv">text = </span><span class="nx">self</span><span class="p">.</span><span class="nx">itemToString</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
          <span class="nv">li = </span><span class="nx">$</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">itemTemplate</span><span class="p">(</span>
            <span class="nv">id: </span><span class="nx">value</span><span class="p">.</span><span class="nx">id</span> <span class="o">or</span> <span class="s">&quot;&quot;</span>
            <span class="nv">text: </span><span class="nx">text</span>
          <span class="p">))</span>
          <span class="nx">$</span><span class="p">.</span><span class="nx">data</span> <span class="nx">li</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="nx">value</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;ul&quot;</span><span class="p">,</span> <span class="nx">self</span><span class="p">.</span><span class="nx">el</span><span class="p">).</span><span class="nx">append</span> <span class="nx">li</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;button.bbf-list-edit&quot;</span><span class="p">,</span> <span class="nx">@el</span><span class="p">).</span><span class="nx">button</span>
            <span class="nv">text: </span><span class="kc">false</span>
            <span class="nv">icons:</span>
              <span class="nv">primary: </span><span class="s">&quot;ui-icon-pencil&quot;</span>

          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;button.bbf-list-del&quot;</span><span class="p">,</span> <span class="nx">@el</span><span class="p">).</span><span class="nx">button</span>
            <span class="nv">text: </span><span class="kc">false</span>
            <span class="nv">icons:</span>
              <span class="nv">primary: </span><span class="s">&quot;ui-icon-trash&quot;</span>

    <span class="nv">editItem: </span><span class="nf">(event) -&gt;</span>
      <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
      <span class="nv">self = </span><span class="k">this</span>
      <span class="nv">li = </span><span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">closest</span><span class="p">(</span><span class="s">&quot;li&quot;</span><span class="p">)</span>
      <span class="nv">originalValue = </span><span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">li</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot;data&quot;</span><span class="p">)</span>
      <span class="nx">@openEditor</span> <span class="nx">originalValue</span><span class="p">,</span> <span class="nf">(newValue) -&gt;</span>
        <span class="nx">triggerCancellableEvent</span> <span class="nx">self</span><span class="p">,</span> <span class="s">&quot;editItem&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="nx">newValue</span> <span class="p">],</span> <span class="o">-&gt;</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&quot;.bbf-list-text&quot;</span><span class="p">,</span> <span class="nx">li</span><span class="p">).</span><span class="nx">html</span> <span class="nx">self</span><span class="p">.</span><span class="nx">itemToString</span><span class="p">(</span><span class="nx">newValue</span><span class="p">)</span>
          <span class="nx">$</span><span class="p">.</span><span class="nx">data</span> <span class="nx">li</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="nx">newValue</span>

    <span class="nv">deleteItem: </span><span class="nf">(event) -&gt;</span>
      <span class="nv">remove = </span><span class="o">-&gt;</span>
        <span class="nx">triggerCancellableEvent</span> <span class="nx">self</span><span class="p">,</span> <span class="s">&quot;removeItem&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="nx">data</span> <span class="p">],</span> <span class="o">-&gt;</span>
          <span class="nx">li</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
      <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
      <span class="nv">self = </span><span class="k">this</span>
      <span class="nv">li = </span><span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">closest</span><span class="p">(</span><span class="s">&quot;li&quot;</span><span class="p">)</span>
      <span class="nv">data = </span><span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">li</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot;data&quot;</span><span class="p">)</span>
      <span class="nv">confirmDelete = </span><span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nx">@schema</span><span class="p">.</span><span class="nx">confirmDelete</span><span class="p">)</span> <span class="k">then</span> <span class="nx">@schema</span><span class="p">.</span><span class="nx">confirmDelete</span> <span class="k">else</span> <span class="kc">false</span><span class="p">)</span>
      <span class="nv">confirmMsg = </span><span class="nx">@schema</span><span class="p">.</span><span class="nx">confirmDeleteMsg</span> <span class="o">or</span> <span class="s">&quot;Are you sure?&quot;</span>
      <span class="k">if</span> <span class="nx">@schema</span><span class="p">.</span><span class="nx">confirmDelete</span>
        <span class="nx">remove</span><span class="p">()</span>  <span class="k">if</span> <span class="nx">confirm</span><span class="p">(</span><span class="nx">confirmMsg</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="nx">remove</span><span class="p">()</span>

    <span class="nv">openEditor: </span><span class="nf">(data, callback) -&gt;</span>
      <span class="nv">self = </span><span class="k">this</span>
      <span class="nv">schema = </span><span class="nx">@schema</span>
      <span class="nv">listType = </span><span class="nx">schema</span><span class="p">.</span><span class="nx">listType</span> <span class="o">or</span> <span class="s">&quot;Text&quot;</span>
      <span class="nv">editor = </span><span class="nx">Form</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">createEditor</span><span class="p">(</span><span class="nx">listType</span><span class="p">,</span>
        <span class="nv">key: </span><span class="s">&quot;&quot;</span>
        <span class="nv">schema: </span><span class="nx">schema</span>
        <span class="nv">value: </span><span class="nx">data</span>
      <span class="p">).</span><span class="nx">render</span><span class="p">()</span>
      <span class="nv">container = </span><span class="nx">$</span><span class="p">(</span><span class="nx">@editorTemplate</span><span class="p">())</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;.bbf-list-editor&quot;</span><span class="p">,</span> <span class="nx">container</span><span class="p">).</span><span class="nx">html</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">el</span>
      <span class="nv">close = </span><span class="o">-&gt;</span>
        <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">unbind</span> <span class="s">&quot;keydown&quot;</span><span class="p">,</span> <span class="nx">handleEnterPressed</span>
        <span class="nx">container</span><span class="p">.</span><span class="nx">dialog</span> <span class="s">&quot;close&quot;</span>
        <span class="nx">editor</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
        <span class="nx">container</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>

      <span class="nv">saveAndClose = </span><span class="o">-&gt;</span>
        <span class="nv">errs = </span><span class="nx">editor</span><span class="p">.</span><span class="nx">validate</span><span class="p">()</span>
        <span class="k">return</span>  <span class="k">if</span> <span class="nx">errs</span>
        <span class="nx">callback</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span>
        <span class="nx">close</span><span class="p">()</span>

      <span class="nv">handleEnterPressed = </span><span class="nf">(event) -&gt;</span>
        <span class="k">return</span>  <span class="nx">unless</span> <span class="nx">event</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">is</span> <span class="mi">13</span>
        <span class="nx">saveAndClose</span><span class="p">()</span>

      <span class="nx">$</span><span class="p">(</span><span class="nx">container</span><span class="p">).</span><span class="nx">dialog</span>
        <span class="nv">resizable: </span><span class="kc">false</span>
        <span class="nv">modal: </span><span class="kc">true</span>
        <span class="nv">width: </span><span class="mi">500</span>
        <span class="nv">title: </span><span class="p">(</span><span class="k">if</span> <span class="nx">data</span> <span class="k">then</span> <span class="s">&quot;Edit item&quot;</span> <span class="k">else</span> <span class="s">&quot;New item&quot;</span><span class="p">)</span>
        <span class="nv">buttons:</span>
          <span class="nv">OK: </span><span class="nx">saveAndClose</span>
          <span class="nv">Cancel: </span><span class="nx">close</span>

      <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">bind</span> <span class="s">&quot;keydown&quot;</span><span class="p">,</span> <span class="nx">handleEnterPressed</span>

    <span class="nv">getValue: </span><span class="o">-&gt;</span>
      <span class="nv">data = </span><span class="p">[]</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;li&quot;</span><span class="p">,</span> <span class="nx">@el</span><span class="p">).</span><span class="nx">each</span> <span class="nf">(index, li) -&gt;</span>
        <span class="nx">data</span><span class="p">.</span><span class="nx">push</span> <span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">li</span><span class="p">,</span> <span class="s">&quot;data&quot;</span><span class="p">)</span>

      <span class="nx">data</span>

    <span class="nv">setValue: </span><span class="nf">(value) -&gt;</span>
      <span class="vi">@value = </span><span class="nx">value</span>
      <span class="nx">@render</span><span class="p">()</span>
  <span class="p">)</span></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><h2>Uneditable form field</h2>

<p>Renders as a <code>span</code> element that users cannot edit.</p>
</td><td class="code"><div class="highlight"><pre>  <span class="k">class</span> <span class="nx">Uneditable</span> <span class="k">extends</span> <span class="nx">Base</span>
    <span class="nv">tagName: </span><span class="s">&#39;span&#39;</span>

    <span class="nv">className: </span><span class="s">&#39;uneditable-input&#39;</span>

    <span class="nv">defaultValue: </span><span class="s">&#39;&#39;</span>

    <span class="nv">render: </span><span class="o">=&gt;</span>
      <span class="nx">@setValue</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">@value</span><span class="p">)</span>
      <span class="nx">@$el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="nx">@key</span><span class="p">)</span>
      <span class="k">return</span> <span class="nx">@</span>

    <span class="nv">getValue: </span><span class="o">-&gt;</span>
      <span class="nx">@$el</span><span class="p">.</span><span class="nx">text</span><span class="p">()</span>

    <span class="nv">setValue: </span><span class="nf">(@value) -&gt;</span>
      <span class="nx">@$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>

  <span class="nv">exports.Uneditable = </span><span class="nx">Uneditable</span>

  <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Form</span><span class="p">.</span><span class="nx">editors</span><span class="p">,</span> <span class="nx">exports</span><span class="p">)</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Fri Jun 29 2012 10:49:01 GMT-0400 (EDT)  </div><div id="projectname"><a href="../../../index.html">Wave Accounting</a></div></div></body></html>